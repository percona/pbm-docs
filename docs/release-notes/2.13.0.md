# Percona Backup for MongoDB 2.13.0
({{date.2_13_0}})

[Installation](../installation.md){.md-button}


Percona Backup for MongoDB (PBM) is a distributed, low-impact solution for creating consistent backups of MongoDB sharded clusters and replica sets, and for restoring those backups to a specific point in time.

## Release Highlights

=== "üõ°Ô∏è Workload Identity Federation (WIF)"
    ### Secure GCS Backups with Workload Identity Federation (WIF)
    Percona Backup for MongoDB (PBM) 2.13.0 now supports **Workload Identity Federation (WIF)** for authenticating with Google Cloud Storage (GCS).

    This feature enables secure backup uploads without relying on static service account JSON keys. Instead, PBM uses short-lived, automatically refreshed tokens obtained through federation with an external identity provider (IdP). 

    Workload Identity Federation lets on-premises or multicloud workloads access Google Cloud resources using federated identities instead of a service account key, eliminating the maintenance and security burden of service account keys.

    To dive deep into this feature, refer to our comprehensive [documentation](https://docs.percona.com/percona-backup-mongodb/details/workload-identity-auth.html).


=== "üîê Selective backups"
    ### Selective backup support with users and roles

    Percona Backup for MongoDB allows you to create selective backups of databases and collections, including the users and roles defined within the database. This ensures that access control is restored along with the data.

    To back up a specific namespace and include users and roles:

    ```bash
    pbm backup --ns="mydb.*" --with-users-and-roles
    ```

    For more insights into this feature, see our [documentation](https://docs.percona.com/percona-backup-mongodb/usage/backup-selective.html#selective-backup-with-users-and-roles).


## Changelog

### New features

- [PBM-1660](https://perconadev.atlassian.net/browse/PBM-1660): Percona Backup for MongoDB (PBM) 2.13.0 now supports **Workload Identity Federation (WIF)** for authenticating with Google Cloud Storage (GCS).

- [PBM-1294](https://perconadev.atlassian.net/browse/PBM-1294): Percona Backup for MongoDB allows you to create selective backups of databases and collections, including the users and roles defined within the database.


### Improvements

- [PBM-1438](https://perconadev.atlassian.net/browse/PBM-1438): Added indexes across all PBM collections to improve query efficiency and reduce response times when accessing `pbmLog` data. This enhancement ensures faster log retrieval and smoother performance during backup and restore operations, particularly in environments with large datasets or frequent queries.

- [PBM-1521](https://perconadev.atlassian.net/browse/PBM-1521): You can now restore the desired database to a specific point in time, including all associated users and roles. This enhancement ensures that both data and access configurations are consistently recovered.

- [PBM-1563](https://perconadev.atlassian.net/browse/PBM-1563): Added support for treating MongoDB error code **50917** (oplog rollover during backup cursor establishment) as a retryable error during physical backups. This aligns with the existing handling of error code **50915** (checkpoint conflict) and improves backup reliability by automatically retrying when transient oplog rollover issues occur.

- [PBM-1645](https://perconadev.atlassian.net/browse/PBM-1645): PBM now triggers a storage re-sync only when the storage identity/connection parameters change. Updates to storage settings that don‚Äôt affect how PBM connects to the backend no longer force a re-sync, reducing unnecessary load and avoiding avoidable delays during configuration changes.

- [PBM-1649](https://perconadev.atlassian.net/browse/PBM-1649): The `pbm cleanup` command now supports targeting a specific storage profile via a new `--profile` flag. You can run `pbm cleanup --older-than=<TIMESTAMP> --profile=<profile_name>` to clean up backups on the selected profile. If `--profile` is omitted, PBM preserves the existing behavior and performs cleanup using the main profile for full backward compatibility.

- [PBM-1663](https://perconadev.atlassian.net/browse/PBM-1663): Enhanced the `pbm status` and `pbm list` commands to display the **Profile (storage)** associated with each backup, making it easier to identify where backups are located. A new option has also been added to filter results by a specific Profile, showing only backups for the chosen storage. 

- [PBM-1665](https://perconadev.atlassian.net/browse/PBM-1665): Point-in-time recovery (PITR) now continues uninterrupted  when logical backups are performed using external storage profiles. The backup process on external storage no longer interrupts oplog slicing on the main storage. PBM saves oplog chunks related to such backups on both the main and external storages, ensuring consistent PITR coverage.

- [PBM-1673](https://perconadev.atlassian.net/browse/PBM-1673): Improved restore output by clarifying oplog replay messages, making progress and restore state easier to interpret.

- [PBM-1690](https://perconadev.atlassian.net/browse/PBM-1690): Percona Backup for MongoDB now supports restarting `pbm-agent` **only at the copyReady** step during external (snapshot-based) restores. At this stage, `mongod` is stopped and the data directory has been cleared, so nodes remain on hold awaiting new snapshot data files to be provided via an external mechanism (for example, snapshot restore or rsync).

## Fixed bugs

- [PBM-1488](https://perconadev.atlassian.net/browse/PBM-1488): Fixed an issue where Point-in-Time Recovery (PITR) would stop saving oplog slices if a failure occurred during the oplog copy process from a backup.

- [PBM-1561](https://perconadev.atlassian.net/browse/PBM-1561): Selective logical restores in sharded clusters now work correctly when the target database or collection already exists. PBM no longer fails due to pre-existing namespaces; during cleanup it drops only the namespaces specified with `--ns` using `_shardsvrDropCollection` for `--ns "db.coll"` and `_shardsvrDropDatabase` for `--ns "db.*".` The same fix applies to PITR restores (`--time`).

- [PBM-1614](https://perconadev.atlassian.net/browse/PBM-1614): Resolved issues with backup metadata serialization and error handling. PBM now reliably encodes/decodes and persists metadata in external storage by using a value type (avoiding nil pointer cases), provides more descriptive errors across backup workflows, and includes new MinIO-based tests to validate metadata serialization round-trips.

- [PBM-1691](https://perconadev.atlassian.net/browse/PBM-1691): Resolved an issue where the PBM CLI exposed SSE credentials in JSON output.

